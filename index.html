<html>
<head>
    <meta charset="utf-8">
    <script src="https://d3js.org/d3.v3.min.js"> </script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap" rel="stylesheet">
    <style>
       body {
           font-family: "Source-Sans-Pro", sans-serif;
       }
       .bar {
           fill: #568203;
       }
       .axis {
           font-size: 13px;
       }
       .axis path,
       .axis line {
           fill: none;
           display: none;
       }

       .label {
           font-size: 13px;
        }

       .bar {
           fill: #568203;
       }

       .organic {
         fill: #cc0
       }

       .bar:hover {
         fill: orange;
       }

       .bar:hover label {
         display: inline;
       }

   </style>

</head>

<body>
  <script>

   d3.json("df.json", function(error, json) {

     if (error) {
       console.log("error data");
     } else {
       data = json
       console.log(data);
     }

   var margin = {
     top: 24,
     right: 12,
     bottom: 15,
     left: 60
   };

   var barHeight = 10,
      gapBetweenGroups = 40;

   var width = 1200 - margin.left - margin.right,
       height = 2200 - margin.top - margin.bottom;

   var xscale = d3.scale.linear()
     .domain([0, 3])
     .range([0, 822]);

   var yscale = d3.scale.linear()
     .domain([0, json.length])
     .range([0, 480]);

//creates main svg
   var svg = d3.select("body").append("svg")
     .attr("width", xscale)
     .attr("height", height + margin.top + margin.bottom)
     .append("g")
     .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

   var x = d3.scale.linear()
     .range([0, width])
     .domain([0, d3.max(data, function (d) {
       return d.ASP_max;
     })]);

   var y = d3.scale.ordinal()
     .rangeRoundBands([height, 0], .2)
     .domain(data.map(function (d) {
       return d.month_year;
     }))

   var y1 = d3.scale.ordinal();

//creates the axis
   var yAxis = d3.svg.axis()
     .scale(y)
     //no tick marks
     .tickSize(0)
     .orient("left");

  var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom")

  var gy = svg.append("g")
     .attr("class", "y axis")
     .call(yAxis)

  var gx = svg.append("g")
    .attr("class", "x axis")
    .attr('transform', 'translate(0,' + (- barHeight) + ')')
    .call(xAxis)

  var bars = svg.selectAll(".bar")
    .data(data)
    .enter()
    .append("g")

//creates the rectangles
   bars.append("rect")
     .attr("class", "bar")
     .attr("y", function (d) {
        return y(d.month_year)})
     // .attr("y", function (d) {
     //   if (d.type = "Conventional") {
     //     return y(d.month_year) + 16
     //   } else {
     //     return y(d.month_year)})
     //   })
     .attr("height", y.rangeBand())
     .attr("x", 0)
     .attr("width", function (d) {
       return x(d.ASP_max - d.ASP_min);
     })
     .attr("x", function(d) {
       return x(d.ASP_min);
     });

   //add a value label to the right of each bar
   bars.append("text")
     .attr("class", "label")
     //y position of the label is halfway down the bar
     .attr("y", function (d) {
       return y(d.month_year) + y.rangeBand() / 2 + 4;
     })
     //x position is 3 pixels to the right of the bar
     .attr("x", function (d) {
       return x(d.ASP_max) + 10;
     })
     .text(function (d) {
       return d.ASP_max + " (" + d.State_Max + ")";
     });

     bars.append("text")
       .attr("class", "label")
       //y position of the label is halfway down the bar
       .attr("y", function (d) {
         return y(d.month_year) + y.rangeBand() / 2 + 4;
       })
<<<<<<< HEAD
      .attr("height", y.rangeBand()/2)
      .attr("x", 0)
      .attr("width", function (d) {
        return x(d.ASP_max - d.ASP_min);
      })
      .attr("x", function(d) {
        return x(d.ASP_min);
      })
    });


    //add a value label to the right of each bar
  bars.append("text")
    .attr("class", "label")
    .attr("dy", 12)
    .attr("y", function (d) {
     if (d.type == "Organic") {
         return y(d.month_year)
       }
       else {
         return y(d.month_year) + 19
       }
      // return y(d.month_year) + y.rangeBand() / 2 + 4;
    })
    //x position is 3 pixels to the right of the bar
    .attr("x", function (d) {
      return x(d.ASP_max) + 64;
    })
    .text(function (d) {
      return d.ASP_max + " (" + d.State_Max + ")";
    });

    bars.append("text")
      .attr("text-anchor", "end")
      .attr("class", "label")
      .attr("dy", 12)
      .attr("y", function (d) {
       if (d.type == "Organic") {
         return y(d.month_year)
       }
       else {
         return y(d.month_year) + 19
       }
      })
      .attr("x", function (d) {
        return x(d.ASP_min) - 8;
      })
      .text(function (d) {
        return "(" + d.State_Min + ") " + d.ASP_min;
      })

=======
>>>>>>> parent of 29e6caa... fixed labels and heights
       //x position is 3 pixels to the right of the bar
       .attr("x", function (d) {
         return x(d.ASP_min) +  10;
       })
       .text(function (d) {
         return d.ASP_min + " (" + d.State_Min + ")";
       });

   ;
 </script>

</body>
